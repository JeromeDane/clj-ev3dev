<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>ev3dev-lang.motor documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Ev3dev-lang 0.1.3-SNAPSHOT API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ev3dev-lang</span></div></div></li><li class="depth-2 branch"><a href="ev3dev-lang.devices.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>devices</span></div></a></li><li class="depth-2 branch"><a href="ev3dev-lang.led.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>led</span></div></a></li><li class="depth-2 branch current"><a href="ev3dev-lang.motor.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>motor</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sensors</span></div></div></li><li class="depth-3 branch"><a href="ev3dev-lang.sensors.color.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>color</span></div></a></li><li class="depth-3 branch"><a href="ev3dev-lang.sensors.infrared.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>infrared</span></div></a></li><li class="depth-3"><a href="ev3dev-lang.sensors.touch.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>touch</span></div></a></li><li class="depth-2"><a href="ev3dev-lang.ssh.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>ssh</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="ev3dev-lang.motor.html#var-address"><div class="inner"><span>address</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-driver-name"><div class="inner"><span>driver-name</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-duty-cycle"><div class="inner"><span>duty-cycle</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-duty-cycle-sp"><div class="inner"><span>duty-cycle-sp</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-find-motor"><div class="inner"><span>find-motor</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-polarity"><div class="inner"><span>polarity</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-position"><div class="inner"><span>position</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-position-sp"><div class="inner"><span>position-sp</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-reset"><div class="inner"><span>reset</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-run-direct"><div class="inner"><span>run-direct</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-run-forever"><div class="inner"><span>run-forever</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-run-timed"><div class="inner"><span>run-timed</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-run-to-abs-pos"><div class="inner"><span>run-to-abs-pos</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-run-to-rel-pos"><div class="inner"><span>run-to-rel-pos</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-speed"><div class="inner"><span>speed</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-speed-regulation"><div class="inner"><span>speed-regulation</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-speed-sp"><div class="inner"><span>speed-sp</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-state"><div class="inner"><span>state</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-stop"><div class="inner"><span>stop</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-stop-action"><div class="inner"><span>stop-action</span></div></a></li><li class="depth-1"><a href="ev3dev-lang.motor.html#var-time-sp"><div class="inner"><span>time-sp</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">ev3dev-lang.motor</h2><div class="doc"><pre class="plaintext"></pre></div><div class="public anchor" id="var-address"><h3>address</h3><div class="usage"><code>(address {:keys [config id]})</code></div><div class="doc"><pre class="plaintext">Get the port the motor is plugged into
</pre></div></div><div class="public anchor" id="var-driver-name"><h3>driver-name</h3><div class="usage"><code>(driver-name {:keys [config id]})</code></div><div class="doc"><pre class="plaintext">Get the driver name of the motor
</pre></div></div><div class="public anchor" id="var-duty-cycle"><h3>duty-cycle</h3><div class="usage"><code>(duty-cycle {:keys [config id]})</code></div><div class="doc"><pre class="plaintext">Get the current duty cycle value of a motor. Returns a numerical value.

The duty cycle is used with speed-regulation &quot;:off&quot;
and is useful when you just want to turn
the motor on and are not too concerned with how stable
the speed is. The duty cycle attribute accepts values from -100 to +100.
The sign of the attribute determines the direction of the motor.
You can update the duty cycle while the motor is running.</pre></div></div><div class="public anchor" id="var-duty-cycle-sp"><h3>duty-cycle-sp</h3><div class="usage"><code>(duty-cycle-sp {:keys [config id]})</code><code>(duty-cycle-sp {:keys [config id]} value)</code></div><div class="doc"><pre class="plaintext">Get or set the target duty cycle &quot;set point&quot; value. Returns a numerical value.

See `duty-cycle` function for further details.</pre></div></div><div class="public anchor" id="var-find-motor"><h3>find-motor</h3><div class="usage"><code>(find-motor {:keys [env], :as config} port)</code></div><div class="doc"><pre class="plaintext">Finds a motor that is plugged into given port. Available ports are:
:a, :b, :c, :d. Returns a map defining the motor if found
on the given port, or nil if no motor was found on the given port.</pre></div></div><div class="public anchor" id="var-polarity"><h3>polarity</h3><div class="usage"><code>(polarity {:keys [config id]})</code><code>(polarity {:keys [config id]} polarity-value)</code></div><div class="doc"><pre class="plaintext">Changes the forward direction of a motor.

This is useful, for example, when you have two motors used as drive
wheels. By changing the polarity of one of the two motors, you can
send a positive value to both motors to drive forwards.

Polarity can be set to :normal or :inversed. The default is :normal.</pre></div></div><div class="public anchor" id="var-position"><h3>position</h3><div class="usage"><code>(position {:keys [config id]})</code></div><div class="doc"><pre class="plaintext">Gets or the current position of the motor.
</pre></div></div><div class="public anchor" id="var-position-sp"><h3>position-sp</h3><div class="usage"><code>(position-sp {:keys [config id]})</code><code>(position-sp {:keys [config id]} position-value)</code></div><div class="doc"><pre class="plaintext">Gets or sets the target &quot;set point&quot; position of the motor.
</pre></div></div><div class="public anchor" id="var-reset"><h3>reset</h3><div class="usage"><code>(reset {:keys [config id]})</code></div><div class="doc"><pre class="plaintext">Reset all of the parameters back to the default values and stop the motor.

It&apos;s a good idea to send this command at the start of a program to ensure the motor
is in a known state without having to write each of the parameters individually.</pre></div></div><div class="public anchor" id="var-run-direct"><h3>run-direct</h3><div class="usage"><code>(run-direct {:keys [config id], :as motor})</code><code>(run-direct {:keys [config id], :as motor} speed-value)</code></div><div class="doc"><pre class="plaintext">Runs a motor just like :run-forever, but immediately changes `speed-regulation`
to :off and causes changes to `duty-cycle-sp` to take effect immediately
instead of having to send a new run command. To update the duty-cycle
run command: (duty-cycle-sp my-motor my-speed)

This is useful for implementing your own PID or something similar that needs to
update the motor output very quickly.</pre></div></div><div class="public anchor" id="var-run-forever"><h3>run-forever</h3><div class="usage"><code>(run-forever {:keys [config id]})</code><code>(run-forever {:keys [config id], :as motor} speed-value)</code></div><div class="doc"><pre class="plaintext">Runs the motor at the given port.
The meaning of `speed` parameter depends on whether the
speed-regulation is turned on or off.

When speed-regulation is off (by default) `speed` ranges
from -100 to 100 and it&apos;s absolute value indicates the percent
of motor&apos;s power usage. It can be roughly interpreted as a motor
speed, but deepending on the environment, the actual speed of the
motor may be lower than the target speed.

When speed-regulation is on, which must first be enabled by calling
`(speed-regulation my-motor :on)`, the motor driver attempts to keep the motor speed at the `speed`
value you&apos;ve specified which ranges from -2000 to 2000.

Negative values indicate reverse motion regardless of speed-regulation.</pre></div></div><div class="public anchor" id="var-run-timed"><h3>run-timed</h3><div class="usage"><code>(run-timed {:keys [config id]})</code><code>(run-timed {:keys [config id], :as motor} time)</code></div><div class="doc"><pre class="plaintext">Runs a motor for a specified time asynchronously.
It starts the motor using :run-forever command and sets a timer in the kernel
to run the :stop command after the specified time. The time is in milliseconds,
and is written with `time-sp`</pre></div></div><div class="public anchor" id="var-run-to-abs-pos"><h3>run-to-abs-pos</h3><div class="usage"><code>(run-to-abs-pos {:keys [config id]})</code><code>(run-to-abs-pos {:keys [config id], :as motor} position-value)</code></div><div class="doc"><pre class="plaintext">Run to an absolute position and then stop using the action specified
by stop-action.</pre></div></div><div class="public anchor" id="var-run-to-rel-pos"><h3>run-to-rel-pos</h3><div class="usage"><code>(run-to-rel-pos {:keys [config id]})</code><code>(run-to-rel-pos {:keys [config id], :as motor} position)</code></div><div class="doc"><pre class="plaintext">Runs the motor to relative position specified by position-sp or a supplied
numeric value as a second argument.

This function can be invoked either without specifying position and using the
current value, or with a position passed in, e.g.
(run-to-rel-pos my-motor)
(run-to-rel-pos my-motor 180)

NOTE: Using a negative value for a position will cause the motor to rotate in
the opposite direction.</pre></div></div><div class="public anchor" id="var-speed"><h3>speed</h3><div class="usage"><code>(speed {:keys [config id]})</code></div><div class="doc"><pre class="plaintext">Read the current speed of the motor when speed-regulation &quot;:on&quot;.
</pre></div></div><div class="public anchor" id="var-speed-regulation"><h3>speed-regulation</h3><div class="usage"><code>(speed-regulation {:keys [config id]} mode)</code><code>(speed-regulation {:keys [config id]})</code></div><div class="doc"><pre class="plaintext">Toggle speed-regulation of the motor to :off or :on.
Default mode is :off.

:off mode
In this mode, the motor driver uses the duty cycle
to determine what percentage of the battery voltage
to send to the motor.
If you run the motor at a fairly low duty cycle, and
you try to stop the hub of the motor with your thumb,
you&apos;ll find it&apos;s pretty easy to slow down or even stop
the motor. In some cases, this is not what you want. You
want the motor to &apos;try harder&apos; when it encounters
resistanceand - and the regulation_mode attribute is
going to help us with that.

:on mode
When the regulation_mode attribute is set to on, the motor
driver attempts to keep the motor speed at the value you&apos;ve
specified.
You can change the speed by calling set-speed function, e.g.
(set-speed config id 275)

If you slow down the motor with a load, the motor driver tries
to compensate by sending more power to the motor to get it to
speed up. If you speed up the motor for some reason, the motor
driver will try to compensate by sending less power to the motor.</pre></div></div><div class="public anchor" id="var-speed-sp"><h3>speed-sp</h3><div class="usage"><code>(speed-sp {:keys [config id]})</code><code>(speed-sp {:keys [config id]} speed)</code></div><div class="doc"><pre class="plaintext">Get or set the target &quot;set point&quot; speed of a motor, in tacho counts per
second used with speed-regulation &quot;:on&quot;.</pre></div></div><div class="public anchor" id="var-state"><h3>state</h3><div class="usage"><code>(state {:keys [config id]})</code></div><div class="doc"><pre class="plaintext">Reading returns a vector of state flags. Possible flags are :running,
:ramping, :holding, :overloaded and :stalled.</pre></div></div><div class="public anchor" id="var-stop"><h3>stop</h3><div class="usage"><code>(stop {:keys [config id]})</code><code>(stop {:keys [config id], :as motor} behavior)</code></div><div class="doc"><pre class="plaintext">Stops the motor:
(stop config id)

The recommended way of stopping is to set the behaviout beforehand, e.g.
(set-stop-behavior config id :coast)
There are three possible behaviours when the motor stops:
:coast, :brake and :hold, described in more detail in set-stop-behavior
docstring.

We can also pass in required behavior to stop function:
(stop config id :coast)</pre></div></div><div class="public anchor" id="var-stop-action"><h3>stop-action</h3><div class="usage"><code>(stop-action {:keys [config id]})</code><code>(stop-action {:keys [config id]} behavior)</code></div><div class="doc"><pre class="plaintext">Get or set the current stop behavior of a motor. Allowed behaviours are:
:brake, :coast and :hold.

:coast - the power will be removed from the motor and it will coast to a stop
:brake - passive braking; the motor controller removes power from the motor, but it
         also shorts the power wires of the motor together. When a motor is manually
         rotated, it acts as an electrical generator, so shorting the power wires
         creates a load that absorbs energy.
:hold  - actively hold the motor position when stopping. Instead of removing power
         from the motor, the motor controller will start a PID to prevent the motor
         from being turned any further. It&apos;s intended for use with run-to-*-pos
         commands. It will work with other run commands, but may result in unexpected
         behaviour.</pre></div></div><div class="public anchor" id="var-time-sp"><h3>time-sp</h3><div class="usage"><code>(time-sp {:keys [config id]})</code><code>(time-sp {:keys [config id]} speed)</code></div><div class="doc"><pre class="plaintext">Get or set the target &quot;set point&quot; time in milliseconds to use with run-timed.
</pre></div></div></div></body></html>